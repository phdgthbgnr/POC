(function(U,P,S,Q,p,a){var x=P,ac=S,u=Q,l=p,d=a,q={},g={},C=0,k="",X=U.$dc("header").getBoundingClientRect().bottom;window.token=0;window.refreshjson=0;window.semaine=0;window.panik=0;if(ac===1){k="token="+x+"&action=semfifajoueur";U.promises.httpRequest("_services/endPoint.php","POST",k,9000).then(function(r){var m=JSON.parse(r)}).fail(function(m){if(m){console("erreur")}n=false}).progress(function(m){}).fin(function(){n=false})}else{k="";U.promises.httpRequest("_json/selectionfifa-"+u+".json","GET",k,9000).then(function(r){var m=JSON.parse(r);q=m.data;E()}).fail(function(m){if(m){console("erreur")}}).progress(function(m){}).fin(function(){})}var n=false,y="",c="_img/_joueurs/",w="_img/_joueurscanvas/",M=U.$dc("intro"),H=U.$dc("selection"),f=U.$dc("formulaire"),K=U.$dc("partages"),O=U.$dc("shareimg"),D=U.$dc("sharecanvas"),ab=D.getContext("2d"),F=11,o=0,b,Y=function(r){var m="";for(m in g){if(g[m]["joueurid"]==r){return true}}return false},W=function(){var ad={ag:"ailierg",g:"gardien",dc:"defenseurc",dg:"defenseurg",dd:"defenseurd",ad:"ailierd",bu:"buteur",mc:"milieuc",mdc:"milieudc"};var t="";var s="";for(t in q){s=ad[t];var m="";for(var r=0;r<q[t].length;r++){var ae=q[t][r];var af=Y(ae.id)==true?" insel":"";m+='<li><a href="#'+t+'" id="joueur-'+ae.id+'" class="seljoueur'+af+'"><img src="_img/nojoueur.png" alt="'+ae.prenom+" "+ae.nom+'" data-src-'+t+'="'+ae.image+'" /><p><span class="nom">'+ae.prenom+" "+ae.nom+'</span><span class="perf">'+ae.performance+"</span></p></a></li>"}U.$dc(s).childNodes[1].childNodes[3].innerHTML=m}U.listenClass("seljoueur","click",aa,true)},aa=function(ai,ah,ak){var s=ah.getAttribute("id");var aj=U.$dc(s);var ad=s.substring(7);g[y]["joueurid"]=ad;for(var ag=0;ag<ai.currentTarget.parentNode.parentNode.childNodes.length;ag++){var af=ai.currentTarget.parentNode.parentNode.childNodes[ag];var r=af.firstChild.getAttribute("id");if(r!=s){var m=r.substring(7);if(U.hasAclass(r,"insel")&&!Y(m)){U.removeAclass(r,"insel")}}}if(!U.hasAclass(s,"insel")){U.addAclass(s,"insel")}R("rmcfifafut2017",g,30);G();J();var ae=aj.parentNode.parentNode.parentNode.parentNode;U.addAclass(ae,"nodisplay")},G=function(){var r=true;for(var m in g){if(g[m]["joueurid"]==""){r=false}}if(r){U.removeAclass("continuer","nodisplay");U.addAclass("legende","nodisplay");window.scrollTo(0,document.body.scrollHeight)}else{U.removeAclass("legende","nodisplay");U.addAclass("continuer","nodisplay")}},N=function(s,r,m){var ad=s.target.parentNode.parentNode.parentNode.getAttribute("id");if(!U.hasAclass(ad,"nodisplay")){U.addAclass(ad,"nodisplay")}return false},T=function(ah,ae,aj){var m=ah.currentTarget.id;for(var ad=0;ad<ae.parentNode.parentNode.childNodes.length;ad++){var r=ae.parentNode.parentNode.childNodes[ad];try{var ai=r.getElementsByTagName("a");U.removeAclass(ai[0],"current")}catch(ah){}}U.addAclass(m,"current");var af="";var s="";var ag="";switch(m){case"buteur1":af="bu";s="buteur";ag="data-src-bu";break;case"ailier1":af="ag";s="ailierg";ag="data-src-ag";break;case"ailier2":af="ad";s="ailierd";ag="data-src-ad";break;case"milieu1":af="mc1";s="milieuc";ag="data-src-mc";break;case"milieu2":af="mc2";s="milieuc";ag="data-src-mc";break;case"milieu3":af="mdc";s="milieudc";ag="data-src-mdc";break;case"defenseur1":af="dg";s="defenseurg";ag="data-src-dg";break;case"defenseur2":af="dc1";s="defenseurc";ag="data-src-dc";break;case"defenseur3":af="dc2";s="defenseurc";ag="data-src-dc";break;case"defenseur4":af="dd";s="defenseurd";ag="data-src-dd";break;case"gardien1":af="g";s="gardien";ag="data-src-g";break}if(af=="mc1"){A("milieuc","mc2")}if(af=="mc2"){A("milieuc","mc1")}if(af=="dc1"){A("defenseurc","dc2")}if(af=="dc2"){A("defenseurc","dc1")}y=af;if(U.hasAclass(s,"nodisplay")){U.removeAclass(s,"nodisplay")}V(function(){},ag,c);return false},A=function(t,s){var ae;var ad;var m;for(var r=0;r<U.$dc(t).childNodes[1].childNodes[3].childNodes.length;r++){ae=U.$dc(t).childNodes[1].childNodes[3].childNodes[r];ad=ae.firstChild.getAttribute("id").substring(7);m=g[s]["joueurid"]==ad?true:false;if(m){U.addAclass(ae.firstChild,"noselec")}else{U.removeAclass(ae.firstChild,"noselec")}}},R=function(s,ad,ae){var t=JSON.stringify(ad);var m="";if(ae){var r=new Date();r.setTime(r.getTime()+(ae*24*60*60*1000));m="; expires="+r.toUTCString()}document.cookie=s+"="+t+m+"; path=/"},L=function(r){var t=r+"=";var m=document.cookie.split(";");for(var s=0;s<m.length;s++){var ad=m[s];while(ad.charAt(0)==" "){ad=ad.substring(1,ad.length)}if(ad.indexOf(t)==0){return ad.substring(t.length,ad.length)}}return null},B=function(m){R(m,"",-1)},I=function(aq,s,ag){var ak=aq.currentTarget.id;switch(ak){case"participer":U.removeAclass(H,"nodisplay");U.addAclass(M,"nodisplay");window.scrollTo(0,X);break;case"continuer":U.addAclass(H,"nodisplay");U.removeAclass(f,"nodisplay");e();break;case"valider":if(U.hasAclass("nom","erreur")){U.removeAclass("nom","erreur")}if(U.hasAclass("prenom","erreur")){U.removeAclass("prenom","erreur")}if(U.hasAclass("email","erreur")){U.removeAclass("email","erreur")}if(U.hasAclass("mention","erreur")){U.removeAclass("mention","erreur")}var ad=new Array();var al=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[A-Z]{2}|fr|com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum)\b/;var am=U.$dc("email").value.toLowerCase();if(!al.test(am)){ad.push("email")}if(U.$dc("nom").value.trim()==""){ad.push("nom")}if(U.$dc("prenom").value.trim()==""){ad.push("prenom")}if(U.$dc("reglement").checked==false){ad.push("mention")}if(ad.length==0&&n==false){var at=U.$dc("saveprofil");var ae=h(at);ae.push("selection="+JSON.stringify(g));ae.push("semaine="+u);k=ae.join("&");n=true;U.addAclass("valider","nodisplay");U.addAclass("retour","nodisplay");U.removeAclass("patienter","nodisplay");U.promises.httpRequest("_services/endPoint.php","POST",k,30000).then(function(au){var t=JSON.parse(au);if(t.error=="ok"){if(t.data.match("^([a-zA-Z0-9]){40}-([0-9]{6})$")){C=t.id;U.$dc("imgshare").setAttribute("data-shrc","_sharing/"+t.data+".jpg");U.$dc("download").setAttribute("href","_sharing/_adwnld.php?token="+x+"&shareimg="+t.data);U.$dc("facebook").setAttribute("href","#"+t.data);U.$dc("twitter").setAttribute("href","#"+t.data)}}V(function(){setTimeout(function(){U.addAclass(f,"nodisplay");U.removeAclass(K,"nodisplay");U.removeAclass("valider","nodisplay");U.removeAclass("retour","nodisplay");U.addAclass("patienter","nodisplay");n=false},500)},"data-shrc","")}).fail(function(t){if(t){console("erreur")}n=false}).progress(function(t){}).fin(function(){})}else{for(var ao=0;ao<ad.length;ao++){U.addAclass(ad[ao],"erreur")}}break;case"retour":U.addAclass("formulaire","nodisplay");U.removeAclass("selection","nodisplay");break;case"download":break;case"facebook":b=aq.currentTarget.getAttribute("href").substring(1);var ar="http://trophee-fut-rmcsport.bfmtv.com/_sharing/"+b+".jpg";FB.ui({method:"feed",name:"RMCSPORT FIFA UTIMATE TEAM",link:"http://trophee-fut-rmcsport.bfmtv.com/?imgsh="+b,picture:ar,description:"Crée ton équipe FIFA ULTIMATE TEAM et tente de gagner des cartes FUT !",caption:"RMCSPORT.BFMTV.COM"},function(t){if(t!==undefined){k="token="+x+"&curid="+C+"&action=sharefacebook";U.promises.httpRequest("_services/endPoint.php","POST",k,30000).then(function(au){}).fail(function(au){if(au){console("erreur")}n=false}).progress(function(au){}).fin(function(){})}});break;case"twitter":b=aq.currentTarget.getAttribute("href").substring(1);var an=575,aj=320,m=300,ai=200,ah="Crée%20ton%20équipe%20FIFA%20ULTIMATE%20TEAM%20et%20tente%20de%20gagner%20des%20cartes%20FUT%20!",ap="http://trophee-fut-rmcsport.bfmtv.com/?imgsh="+b,r="https://twitter.com/intent/tweet/?text="+ah+"&url="+ap,af="status=1,width="+an+",height="+aj+",top="+ai+",left="+m;window.open(r,"twitter",af);break}return false},i=function(ae,t){var m="";var ad="j"+ae;switch(ae){case"mc1":case"mc2":m="mc";break;case"dc1":case"dc2":m="dc";break;default:m=ae;break}var s={};for(var r=0;r<q[m].length;r++){s=q[m][r];if(s.id==t){U.$dc(ad).setAttribute("data-ssrc",s.image);U.$dc(ad).setAttribute("alt",s.prenom+" "+s.nom)}}},E=function(){U.listenClass("poste","click",T,true);U.listenClass("closepopup","click",N,true);U.listenerAdd("valider","click",I,true);U.listenerAdd("continuer","click",I,true);U.listenerAdd("retour","click",I,true);U.listenerAdd("facebook","click",I,true);U.listenerAdd("twitter","click",I,true);if(d==1){U.addAclass("participer","nodisplay")}else{U.removeAclass("participer","nodisplay");U.listenerAdd("participer","click",I,true)}var m=L("rmcfifafut2017");var r=false;if(m!==null){try{g=JSON.parse(m);if(g.bu["week"]){if(g.bu["week"]==u){G()}else{r=true}}else{r=true}}catch(s){r=true}}else{r=true}if(r){g={bu:{joueurid:"",x:537,y:1,x1:268,y1:1,week:u},mc1:{joueurid:"",x:404,y:120,x1:201,y1:62,week:u},mc2:{joueurid:"",x:676,y:120,x1:337,y1:62,week:u},mdc:{joueurid:"",x:540,y:190,x1:269,y1:97,week:u},dg:{joueurid:"",x:209,y:248,x1:105,y1:127,week:u},dd:{joueurid:"",x:870,y:248,x1:434,y1:127,week:u},dc1:{joueurid:"",x:385,y:313,x1:192,y1:159,week:u},dc2:{joueurid:"",x:680,y:313,x1:340,y1:159,week:u},ag:{joueurid:"",x:264,y:44,x1:131,y1:24,week:u},ad:{joueurid:"",x:820,y:44,x1:410,y1:24,week:u},g:{joueurid:"",x:536,y:440,x1:267,y1:221,week:u}}}V(function(){},"data-src","");J();W()},J=function(){var m="";for(m in g){i(m,g[m]["joueurid"])}V(function(){},"data-ssrc",c)},v=function(ah,r,ae,af,ad,ag,s,aj,ai,m,t){if(ae.addEventListener!=undefined){ae.addEventListener("load",function(ak){ah(ae,r,af,ad,ag,s,aj,ai,m,t)})}else{if(ae.readyState){ae.onreadystatechange=function(){if(ae.readyState=="loaded"||ae.readyState=="complete"){ah(ae,r,af,ad,ag,s,aj,ai,m,t)}}}}},e=function(){o=0;ab.save();ab.setTransform(1,0,0,1,0,0);ab.clearRect(0,0,600,315);ab.restore();O.src="_img/blnkequipe.gif";var m=new Image();m.src=w+"bg_share.jpg";v(z,0,m,0,0,600,315,0,0,600,315)},z=function(ai,r,ak,ah,al,af,an,am,m,ag){ab.drawImage(ai,ak,ah,al,af,an,am,m,ag);var ae=new Array();for(var t in g){var aj=t;if(t=="mc1"||t=="mc2"){aj="mc"}if(t=="dc1"||t=="dc2"){aj="dc"}for(var ad=0;ad<q[aj].length;ad++){if(q[aj][ad]["id"]==g[t]["joueurid"]){ae.push(new Image());var s=ae.length-1;ae[s].src=w+q[aj][ad]["image"]+"?req="+Math.random();var ak=g[t]["x1"];var ah=g[t]["y1"];v(j,s,ae[s],0,0,62,92,ak,ah,62,92)}}}},j=function(ae,r,af,ad,ag,s,aj,ai,m,t){ab.drawImage(ae,af,ad,ag,s,aj,ai,m,t);if(ah){clearTimeout(ah)}if(o==F-1){var ah=setTimeout(function(){var ak=D.toDataURL();O.src=ak;U.$dc("dataimg").value=ak;ak=""},100)}o++},V=function(ag,t,ad){var ae=0;var s=document.getElementsByTagName("img");var af=[];for(var m=0;m<s.length;m++){if(U.hasAclass(s[m],"nomobile")&&l==1){continue}if(s[m].getAttribute(t)){af.push(s[m])}}for(var m=0;m<af.length;m++){try{af[m].setAttribute("src",ad+af[m].getAttribute(t))}catch(r){continue}if(af[m].addEventListener!=undefined){af[m].addEventListener("load",function(ah){if(ae>=af.length-1){ag()}ae++})}else{if(af[m].readyState){af[m].onreadystatechange=function(){if(af[m].readyState=="loaded"||af[m].readyState=="complete"){if(ae>=af.length-1){ag()}ae++}}}}}},Z=function(m){switch(m.target.id){case"imgshare":setTimeout(function(){U.addAclass(f,"nodisplay");U.removeAclass(K,"nodisplay");U.removeAclass("valider","nodisplay");U.removeAclass("retour","nodisplay");U.addAclass("patienter","nodisplay");n=false},500);break}return false},h=function(s){if(!s||s.nodeName!=="FORM"){return}var r,m,t=[];for(r=s.elements.length-1;r>=0;r=r-1){if(s.elements[r].name===""){continue}switch(s.elements[r].nodeName){case"INPUT":switch(s.elements[r].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":case"email":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break;case"checkbox":case"radio":if(s.elements[r].checked){t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value))}break;case"file":break}break;case"TEXTAREA":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break;case"SELECT":switch(s.elements[r].type){case"select-one":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break;case"select-multiple":for(m=s.elements[r].options.length-1;m>=0;m=m-1){if(s.elements[r].options[m].selected){t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].options[m].value))}}break}break;case"BUTTON":switch(s.elements[r].type){case"reset":case"submit":case"button":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break}break}}return t};U.listenerAdd(window,"error",function(m){Z(m)},true)}(manageEvents,window.token,window.refreshjson,window.semaine,window.ismobil,window.panik));