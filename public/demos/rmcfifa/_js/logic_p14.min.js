(function(W,R,U,S,q,a,o){var y=R,ae=U,v=S,l=q,d=a,E=o,u={},g={},D=0,k="",Z=W.$dc("header").getBoundingClientRect().bottom;window.token=0;window.refreshjson=0;window.semaine=0;window.panik=0;window.isipad=0;if(ae===1){k="token="+y+"&action=semfifajoueur";W.promises.httpRequest("_services/endPoint.php","POST",k,9000).then(function(r){var m=JSON.parse(r)}).fail(function(m){if(m){console("erreur")}n=false}).progress(function(m){}).fin(function(){n=false})}else{k="";W.promises.httpRequest("_json/selectionfifa-"+v+".json","GET",k,9000).then(function(r){var m=JSON.parse(r);u=m.data;G()}).fail(function(m){if(m){console("erreur")}}).progress(function(m){}).fin(function(){})}var n=false,z="",c="_img/_joueurs/",x="_img/_joueurs/",O=W.$dc("intro"),J=W.$dc("selection"),f=W.$dc("formulaire"),M=W.$dc("partages"),Q=W.$dc("shareimg"),F=W.$dc("sharecanvas"),ad=F.getContext("2d"),H=11,p=0,b,aa=function(r){var m="";for(m in g){if(g[m]["joueurid"]==r){return true}}return false},Y=function(){var af={ag:"ailierg",g:"gardien",dc:"defenseurc",dg:"defenseurg",dd:"defenseurd",ad:"ailierd",bu:"buteur",mc:"milieuc",mdc:"milieudc"};var t="";var s="";for(t in u){s=af[t];var m="";for(var r=0;r<u[t].length;r++){var ag=u[t][r];var ah=aa(ag.id)==true?" insel":"";m+='<li><a href="#'+t+'" id="joueur-'+ag.id+'" class="seljoueur'+ah+'"><img src="_img/nojoueur.png" alt="'+ag.prenom+" "+ag.nom+'" data-src-'+t+'="'+ag.image+'" /><p><span class="nom">'+ag.prenom+" "+ag.nom+'</span><span class="perf">'+ag.performance+"</span></p></a></li>"}W.$dc(s).childNodes[1].childNodes[3].innerHTML=m}W.listenClass("seljoueur","click",ac,true)},ac=function(ak,aj,am){var s=aj.getAttribute("id");var al=W.$dc(s);var af=s.substring(7);g[z]["joueurid"]=af;for(var ai=0;ai<ak.currentTarget.parentNode.parentNode.childNodes.length;ai++){var ah=ak.currentTarget.parentNode.parentNode.childNodes[ai];var r=ah.firstChild.getAttribute("id");if(r!=s){var m=r.substring(7);if(W.hasAclass(r,"insel")&&!aa(m)){W.removeAclass(r,"insel")}}}if(!W.hasAclass(s,"insel")){W.addAclass(s,"insel")}T("rmcfifafut2017",g,30);I();L();var ag=al.parentNode.parentNode.parentNode.parentNode;W.addAclass(ag,"nodisplay")},I=function(){var r=true;for(var m in g){if(g[m]["joueurid"]==""){r=false}}if(r){W.removeAclass("continuer","nodisplay");W.addAclass("legende","nodisplay");window.scrollTo(0,document.body.scrollHeight)}else{W.removeAclass("legende","nodisplay");W.addAclass("continuer","nodisplay")}},P=function(s,r,m){var af=s.target.parentNode.parentNode.parentNode.getAttribute("id");if(!W.hasAclass(af,"nodisplay")){W.addAclass(af,"nodisplay")}return false},V=function(aj,ag,al){var m=aj.currentTarget.id;for(var af=0;af<ag.parentNode.parentNode.childNodes.length;af++){var r=ag.parentNode.parentNode.childNodes[af];try{var ak=r.getElementsByTagName("a");W.removeAclass(ak[0],"current")}catch(aj){}}W.addAclass(m,"current");var ah="";var s="";var ai="";switch(m){case"buteur1":ah="bu";s="buteur";ai="data-src-bu";break;case"ailier1":ah="ag";s="ailierg";ai="data-src-ag";break;case"ailier2":ah="ad";s="ailierd";ai="data-src-ad";break;case"milieu1":ah="mc1";s="milieuc";ai="data-src-mc";break;case"milieu2":ah="mc2";s="milieuc";ai="data-src-mc";break;case"milieu3":ah="mdc";s="milieudc";ai="data-src-mdc";break;case"defenseur1":ah="dg";s="defenseurg";ai="data-src-dg";break;case"defenseur2":ah="dc1";s="defenseurc";ai="data-src-dc";break;case"defenseur3":ah="dc2";s="defenseurc";ai="data-src-dc";break;case"defenseur4":ah="dd";s="defenseurd";ai="data-src-dd";break;case"gardien1":ah="g";s="gardien";ai="data-src-g";break}if(ah=="mc1"){B("milieuc","mc2")}if(ah=="mc2"){B("milieuc","mc1")}if(ah=="dc1"){B("defenseurc","dc2")}if(ah=="dc2"){B("defenseurc","dc1")}z=ah;if(W.hasAclass(s,"nodisplay")){W.removeAclass(s,"nodisplay")}X(function(){},ai,c);return false},B=function(t,s){var ag;var af;var m;for(var r=0;r<W.$dc(t).childNodes[1].childNodes[3].childNodes.length;r++){ag=W.$dc(t).childNodes[1].childNodes[3].childNodes[r];af=ag.firstChild.getAttribute("id").substring(7);m=g[s]["joueurid"]==af?true:false;if(m){W.addAclass(ag.firstChild,"noselec")}else{W.removeAclass(ag.firstChild,"noselec")}}},T=function(s,af,ag){var t=JSON.stringify(af);var m="";if(ag){var r=new Date();r.setTime(r.getTime()+(ag*24*60*60*1000));m="; expires="+r.toUTCString()}document.cookie=s+"="+t+m+"; path=/"},N=function(r){var t=r+"=";var m=document.cookie.split(";");for(var s=0;s<m.length;s++){var af=m[s];while(af.charAt(0)==" "){af=af.substring(1,af.length)}if(af.indexOf(t)==0){return af.substring(t.length,af.length)}}return null},C=function(m){T(m,"",-1)},K=function(at,s,ai){var am=at.currentTarget.id;switch(am){case"participer":W.removeAclass(J,"nodisplay");W.addAclass(O,"nodisplay");window.scrollTo(0,Z);break;case"continuer":W.addAclass(J,"nodisplay");W.removeAclass(f,"nodisplay");e();break;case"valider":if(W.hasAclass("nom","erreur")){W.removeAclass("nom","erreur")}if(W.hasAclass("prenom","erreur")){W.removeAclass("prenom","erreur")}if(W.hasAclass("email","erreur")){W.removeAclass("email","erreur")}if(W.hasAclass("mention","erreur")){W.removeAclass("mention","erreur")}var af=new Array();var an=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[A-Z]{2}|fr|com|org|net|gov|mil|biz|info|mobi|name|aero|jobs|museum)\b/;var ao=W.$dc("email").value.toLowerCase();if(!an.test(ao)){af.push("email")}if(W.$dc("nom").value.trim()==""){af.push("nom")}if(W.$dc("prenom").value.trim()==""){af.push("prenom")}if(W.$dc("reglement").checked==false){af.push("mention")}if(af.length==0&&n==false){var av=W.$dc("saveprofil");var ag=h(av);ag.push("selection="+JSON.stringify(g));ag.push("semaine="+v);k=ag.join("&");n=true;W.addAclass("valider","nodisplay");W.addAclass("retour","nodisplay");W.removeAclass("patienter","nodisplay");W.promises.httpRequest("_services/endPoint.php","POST",k,30000).then(function(aw){var t=JSON.parse(aw);if(t.error=="ok"){if(t.data.match("^([a-zA-Z0-9]){40}-([0-9]{6})$")){D=t.id;W.$dc("imgshare").setAttribute("data-shrc","_sharing/"+t.data+".jpg");W.$dc("download").setAttribute("href","_sharing/_adwnld.php?token="+y+"&shareimg="+t.data);W.$dc("facebook").setAttribute("href","#"+t.data);W.$dc("twitter").setAttribute("href","#"+t.data)}}X(function(){setTimeout(function(){W.addAclass(f,"nodisplay");W.removeAclass(M,"nodisplay");W.removeAclass("valider","nodisplay");W.removeAclass("retour","nodisplay");W.addAclass("patienter","nodisplay");n=false},500)},"data-shrc","")}).fail(function(t){if(t){console("erreur")}n=false}).progress(function(t){}).fin(function(){})}else{for(var aq=0;aq<af.length;aq++){W.addAclass(af[aq],"erreur")}}break;case"retour":W.addAclass("formulaire","nodisplay");W.removeAclass("selection","nodisplay");break;case"download":break;case"facebook":b=at.currentTarget.getAttribute("href").substring(1);var au="http://trophee-fut-rmcsport.bfmtv.com/_sharing/"+b+".jpg";FB.ui({method:"feed",name:"RMCSPORT FIFA ULTIMATE TEAM",link:"http://trophee-fut-rmcsport.bfmtv.com/?imgsh="+b,picture:au,description:"Crée ton équipe FIFA ULTIMATE TEAM et tente de gagner des cartes FUT !",caption:"RMCSPORT.BFMTV.COM"},function(t){if(t!==undefined){k="token="+y+"&curid="+D+"&action=sharefacebook";W.promises.httpRequest("_services/endPoint.php","POST",k,30000).then(function(aw){}).fail(function(aw){if(aw){console("erreur")}n=false}).progress(function(aw){}).fin(function(){})}});break;case"twitter":b=at.currentTarget.getAttribute("href").substring(1);var ap=575,al=320,m=300,ak=200,aj="Crée%20ton%20équipe%20FIFA%20ULTIMATE%20TEAM%20et%20tente%20de%20gagner%20des%20cartes%20FUT%20!",ar="http://trophee-fut-rmcsport.bfmtv.com/?imgsh="+b,r="https://twitter.com/intent/tweet/?text="+aj+"&url="+ar,ah="status=1,width="+ap+",height="+al+",top="+ak+",left="+m;window.open(r,"twitter",ah);break}return false},i=function(ag,t){var m="";var af="j"+ag;switch(ag){case"mc1":case"mc2":m="mc";break;case"dc1":case"dc2":m="dc";break;default:m=ag;break}var s={};for(var r=0;r<u[m].length;r++){s=u[m][r];if(s.id==t){W.$dc(af).setAttribute("data-ssrc",s.image);W.$dc(af).setAttribute("alt",s.prenom+" "+s.nom)}}},G=function(){W.listenClass("poste","click",V,true);W.listenClass("closepopup","click",P,true);W.listenerAdd("valider","click",K,true);W.listenerAdd("continuer","click",K,true);W.listenerAdd("retour","click",K,true);W.listenerAdd("facebook","click",K,true);W.listenerAdd("twitter","click",K,true);if(d==1){W.addAclass("participer","nodisplay")}else{W.removeAclass("participer","nodisplay");W.listenerAdd("participer","click",K,true)}var m=N("rmcfifafut2017");var r=false;if(m!==null){try{g=JSON.parse(m);if(g.bu["week"]){if(g.bu["week"]==v){I()}else{r=true}}else{r=true}}catch(s){r=true}}else{r=true}if(r){g={bu:{joueurid:"",x:537,y:1,x1:268,y1:1,week:v},mc1:{joueurid:"",x:404,y:120,x1:201,y1:62,week:v},mc2:{joueurid:"",x:676,y:120,x1:337,y1:62,week:v},mdc:{joueurid:"",x:540,y:190,x1:269,y1:97,week:v},dg:{joueurid:"",x:209,y:248,x1:105,y1:127,week:v},dd:{joueurid:"",x:870,y:248,x1:434,y1:127,week:v},dc1:{joueurid:"",x:385,y:313,x1:192,y1:159,week:v},dc2:{joueurid:"",x:680,y:313,x1:340,y1:159,week:v},ag:{joueurid:"",x:264,y:44,x1:131,y1:24,week:v},ad:{joueurid:"",x:820,y:44,x1:410,y1:24,week:v},g:{joueurid:"",x:536,y:440,x1:267,y1:221,week:v}}}X(function(){},"data-src","");L();Y()},L=function(){var m="";for(m in g){i(m,g[m]["joueurid"])}X(function(){},"data-ssrc",c)},w=function(aj,r,ag,ah,af,ai,s,al,ak,m,t){if(ag.addEventListener!=undefined){ag.addEventListener("load",function(am){aj(ag,r,ah,af,ai,s,al,ak,m,t)})}else{if(ag.readyState){ag.onreadystatechange=function(){if(ag.readyState=="loaded"||ag.readyState=="complete"){aj(ag,r,ah,af,ai,s,al,ak,m,t)}}}}},e=function(){p=0;ad.save();ad.setTransform(1,0,0,1,0,0);ad.clearRect(0,0,1200,630);ad.restore();Q.src="_img/blnkequipe.gif";var m=new Image();m.src=x+"bg_share.jpg";w(A,0,m,0,0,1200,630,0,0,1200,630)},A=function(ak,r,am,aj,an,ah,ap,ao,m,ai){ad.drawImage(ak,am,aj,an,ah,ap,ao,m,ai);var ag=new Array();for(var t in g){var al=t;if(t=="mc1"||t=="mc2"){al="mc"}if(t=="dc1"||t=="dc2"){al="dc"}for(var af=0;af<u[al].length;af++){if(u[al][af]["id"]==g[t]["joueurid"]){ag.push(new Image());var s=ag.length-1;ag[s].src=x+u[al][af]["image"]+"?req="+Math.random();var am=g[t]["x"];var aj=g[t]["y"];w(j,s,ag[s],0,0,124,184,am,aj,124,184)}}}},j=function(ag,r,ah,af,ai,s,al,ak,m,t){ad.drawImage(ag,ah,af,ai,s,al,ak,m,t);if(aj){clearTimeout(aj)}if(p==H-1){var aj=setTimeout(function(){var am=F.toDataURL("image/jpeg",0.7);Q.src=am;W.$dc("dataimg").value=am;am=""},100)}p++},X=function(ai,t,af){var ag=0;var s=document.getElementsByTagName("img");var ah=[];for(var m=0;m<s.length;m++){if(W.hasAclass(s[m],"nomobile")&&l==1&&E==0){continue}if(s[m].getAttribute(t)){ah.push(s[m])}}for(var m=0;m<ah.length;m++){try{ah[m].setAttribute("src",af+ah[m].getAttribute(t))}catch(r){continue}if(ah[m].addEventListener!=undefined){ah[m].addEventListener("load",function(aj){if(ag>=ah.length-1){ai()}ag++})}else{if(ah[m].readyState){ah[m].onreadystatechange=function(){if(ah[m].readyState=="loaded"||ah[m].readyState=="complete"){if(ag>=ah.length-1){ai()}ag++}}}}}},ab=function(m){switch(m.target.id){case"imgshare":setTimeout(function(){W.addAclass(f,"nodisplay");W.removeAclass(M,"nodisplay");W.removeAclass("valider","nodisplay");W.removeAclass("retour","nodisplay");W.addAclass("patienter","nodisplay");n=false},500);break}return false},h=function(s){if(!s||s.nodeName!=="FORM"){return}var r,m,t=[];for(r=s.elements.length-1;r>=0;r=r-1){if(s.elements[r].name===""){continue}switch(s.elements[r].nodeName){case"INPUT":switch(s.elements[r].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":case"email":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break;case"checkbox":case"radio":if(s.elements[r].checked){t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value))}break;case"file":break}break;case"TEXTAREA":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break;case"SELECT":switch(s.elements[r].type){case"select-one":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break;case"select-multiple":for(m=s.elements[r].options.length-1;m>=0;m=m-1){if(s.elements[r].options[m].selected){t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].options[m].value))}}break}break;case"BUTTON":switch(s.elements[r].type){case"reset":case"submit":case"button":t.push(s.elements[r].name+"="+encodeURIComponent(s.elements[r].value));break}break}}return t};W.listenerAdd(window,"error",function(m){ab(m)},true)}(manageEvents,window.token,window.refreshjson,window.semaine,window.ismobil,window.panik,window.isipad));